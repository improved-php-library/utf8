![improved PHP library](https://user-images.githubusercontent.com/100821/46372249-e5eb7500-c68a-11e8-801a-2ee57da3e5e3.png)

# Skeleton PHP extension

[![Build Status](https://travis-ci.org/improved-php-library/utf8-php-ext.svg?branch=master)](https://travis-ci.org/improved-php-library/utf8-php-ext)
[![Build status](https://ci.appveyor.com/api/projects/status/7rof1vr8mv4kam17/branch/master?svg=true)](https://ci.appveyor.com/project/jasny/utf8-php-ext/branch/master)

Skeleton project for PHP C-extension.

> All other PHP extension utf8s that are available, including the one generated by PHP, are too minimalistic for
> practical use. **Use this utf8 instead.**

Includes;

* Travis (Linux) and AppVeyor (Windows) configuration for continuous integration / platform tests.
  * Automatic deployment of package to GitHub releases
* CMake config for editing in [CLion](https://www.jetbrains.com/clion/). (See [this article](https://dev.to/jasny/developing-a-php-extension-in-clion-3oo1))
* Supported for pecl dependencies.

[> Create a new repository, using the utf8 php extension as template.](https://github.com/improved-php-library/utf8-php-ext/generate)

_This is a work in progress. More goodness will be added._

---

## Requirements

* PHP 7.2+

## Installation

    phpize
    ./configure
    make
    make test
    make install

Add the following line to your `php.ini`

    extension=utf8.so

To try out the extension, you can run the following command

    php -a -d extension=modules/utf8.so

## Functions

### utf8_nop

Return the input (which must be a string).

    string utf8_nop(string input)

---

### Replace example function

Edit the header (`php_foo_bar.h`) and source (`foo_bar.c`) file, replace the declaration and implementation of
`PHP_FUNCTION(utf8_nop)` with your own function(s). Also update `zend_function_entry functions` and create
the argument info for each function.

## PECL package

If you wish to publish your extension to [pecl.php.net](PECL), you need your package to contain a valid `package.xml`.
Create this via

    make package.xml

You can enter the release notes manually or pipe it from a source like a git commit

    git log -1 --pretty=%B | make package.xml

The version is determined base on the version defined in your main header file. Make sure this is correct prior to
running `make package.xml`.

When `package.xml` is first created, not all fields are filled out. Edit the file manually to fill this fields and
verify it with

    pecl package-validate

The make command will automatically update the package content entry and include all source and test files. Other files
can be added manually. The script will only remove files that no longer exist.

## Getting started with PHP internals

_There is a lot of information about the internals and writing PHP extensions online. Unfortunately but this information
is often outdated, including the information found in the PHP manual._

* [PHP extension sample](https://github.com/ThomasWeinert/php-extension-sample) - Collection of sample features for a
    php extension
* [phpinternals.net](https://phpinternals.net/) - An (accurate but incomplete) reference guide of PHP macros and
    functions
* [PHP source code](https://github.com/php/php-src) - If all else fails, look up examples in the PHP source code

